# Deep Transnet

## 研究背景与问题提出

神经网络在偏微分方程（PDE）求解中的成功主要得益于其强大的函数逼近能力。然而，传统 PINN、Deep Ritz 或 DeepONet 等模型普遍存在以下问题：

- **可迁移性差（poor transferability）**：不同 PDE 参数或边界条件下需重新训练；
- **可解释性不足**：网络中间层难以映射到 PDE 的物理算子；
- **训练不稳定**：在高频或刚性 PDE 中收敛困难。

TransNet提出了一种**可迁移谱网络（Transferable Neural Network）**框架，通过随机特征展开与显式线性求解 α 参数，实现了“**一次特征生成，多方程通用迁移**”。
 它的优势是高精度、可解释、线性可解，但同时具有两个核心局限：

1. **全局基函数带来的维度诅咒**：高维输入时基函数数量呈指数增长；
2. **表达能力受限于浅层结构**：无法有效表示非线性复杂 PDE（如非线性波动、湍流等）。

本文聚焦第二个问题，提出研究问题：

> **如何在保持 TransNet 可迁移特征空间优势的同时，引入深层结构以增强表达能力？**

------

##  研究目标

本研究旨在建立一种新的网络架构 —— **Deep-TransNet**，
 在多层结构中延续 TransNet 的核心思想（线性可解 + 可迁移特征空间），
 以实现以下目标：

1. **提出一种深层可迁移网络结构**：
    将 TransNet 的随机谱特征扩展为多层嵌套形式，
    保持特征可解析求解或部分可解析（半线性）；
2. **探索深层结构中的可迁移性条件**：
    从理论上分析多层网络保持可迁移特征的充分条件；
3. **提高复杂 PDE 的表达能力与泛化性能**：
    通过多层结构模拟非线性算子叠加，
    应用于非线性波、Allen–Cahn、Burgers 等 PDE。

------

## 研究假设与核心思想

核心假设：

> **如果深层网络的每一层保持“局部线性可解 + 特征共享”，
>  则整个网络仍可保持 TransNet 式的可迁移性。**

数学形式上：
$$
u^{(L)}(x) = \sigma\Big( \sum_{k=1}^{L} A^{(k)} \sigma(\gamma_k (a^{(k)} \cdot x + r^{(k)})) \Big),
$$
其中每一层的特征 $\phi^{(k)}(x) = \sigma(\gamma_k (a^{(k)} \cdot x + r^{(k)}))$
 可看作独立的谱基映射，线性层 $A^{(k)}$ 可解析求解或弱训练。

与传统 MLP 的区别：

- 不进行全参数端到端训练；
- 各层保持可解释性；
- 深层叠加构成更高阶谱逼近。

------

## 拟解决的关键科学问题

|      | 科学问题                                                     | 可能采用方法                                                 |
| ---- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| Q1   | 深层 TransNet 如何定义“层间可迁移性”？                       | 构造层间共享特征空间，定义 Transfer Condition：$\Phi^{(k)}(x) ≈ \Phi^{(k)}(x'; θ)$ 在 PDE 参数变化下稳定 |
| Q2   | 深层结构中哪些层保持线性可解性？                             | 引入分层线性求解机制（layer-wise least squares），分析可解性条件 |
| Q3   | 深层结构是否能在理论上提升谱逼近上界？                       | 推导多层 TransNet 的逼近误差上界，验证是否优于单层谱展开     |
| Q4   | Deep-TransNet 对复杂 PDE（非线性波、Burgers 方程）能否实现泛化？ | 在数值实验中测试可迁移性与收敛性                             |

------

## 方法设计与技术路线

### **Step 1: 基线构建与验证**

- 复现现有 TransNet 与 Hybrid-TransNet 结果；
- 验证对线性波动方程、Poisson 方程的精度与可迁移性。

### **Step 2: 深层结构设计**

- 构造 **Deep-TransNet v1**：两层结构
  $$
  u(x) = A_2 \tanh(\gamma_2 (A_1 \tanh(\gamma_1 (a\cdot x + r_1)) + r_2))
  $$
  第一层生成特征空间；第二层线性组合并可显式求解。

- 引入共享特征机制：第一层 TransNet 特征在多 PDE 中冻结。

### **Step 3: 半线性求解策略**

- 将线性层 α 的更新视为最小二乘问题；
- 非线性层通过少量梯度微调实现快速适应；
- 实现“半端到端”优化结构。

### **Step 4: 理论分析**

- 分析每层特征映射的 Lipschitz 连续性；
- 证明：若每层映射满足 Lipschitz 常数 $L_k < 1$，则整体保留可迁移性；
- 推导逼近误差上界。

### **Step 5: 数值验证**

- PDE 测试集：
  - 线性波动方程（baseline）
  - Allen–Cahn 方程
  - Burgers 方程（含非线性对流项）
- 指标：
  - MSE 收敛速率；
  - 可迁移性（换 PDE 参数后 fine-tuning 步数）；
  - 谱能量分布（验证多层扩展的高频表示能力）。

------

## 预期成果与创新点

### 主要创新

1. **提出深层可迁移 TransNet 架构**（Deep-TransNet）：
    将谱方法的显式线性可解性扩展至多层非线性网络。
2. **定义层间可迁移性条件（Transfer Condition）**：
    提出判定深层结构可迁移性的理论准则。
3. **建立半线性训练机制（Hybrid Least-Squares + Gradient）**：
    保留物理可解释性与稳定性。

### 预期成果

- 一种可迁移的深层 PDE 网络；
- 关于层间可迁移条件与逼近上界的理论分析；
- 数值验证：在非线性 PDE 中优于单层 TransNet 与 PINN；

------

## 潜在风险与应对策略

| 风险                       | 应对策略                                    |
| -------------------------- | ------------------------------------------- |
| 多层结构难以保持线性可解性 | 引入分层冻结策略，只在特定层优化            |
| 可迁移性指标难以量化       | 定义 fine-tuning 步数、参数扰动响应度等指标 |
| PDE 过于复杂               | 先从 1D 非线性波动方程与 Burgers 开始验证   |

------

## 结论与展望

本研究旨在构建一种结合谱方法可解释性与深度学习表达力的全新网络架构。
 Deep-TransNet 作为 **TransNet 的自然延伸**，
 将在数学可迁移性、谱逼近理论、以及复杂 PDE 建模中，
 提供一种新的研究范式。

> 它不仅是一种网络，更是“可迁移谱表示”的深层化框架。